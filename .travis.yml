matrix:
  include:
    # - language: rust
    #   rust: 1.31.0
    #   cache: cargo 
    #   script:
    #     - cd driver/
    #     - cargo build --verbose --all
    #     - cargo test --verbose --all
    # - language: python
    #   python: 3.6
    #   install:
    #     - pip install -U -r event_listener/requirements.txt
    #   script:
    #     - pytest --cov=event_listener/dfusion_db/ --cov-report term-missing
    #     - mypy event_listener/dfusion_db/ --ignore-missing-imports --strict
    - language: node_js
      sudo: required
      node_js: 10.13.0
      env:
        - DOCKER_COMPOSE_VERSION=1.22.0
      before_install:
        - sudo rm /usr/local/bin/docker-compose
        - curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
        - chmod +x docker-compose
        - sudo mv docker-compose /usr/local/bin
        - npm install -g truffle
      install:
        - git submodule update --init
        - docker-compose up -d
        - sudo npm install -C dex-contracts
      script:
        - sh ./test/e2e-tests-deposit.sh
      after_script:
        - docker-compose down